{"version":3,"sources":["track-reload.vue","index.js"],"names":["install","Vue","options","component","TrackReload"],"mappings":";AASA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EAAA,IAAA,EAAA,CACA,KAAA,cACA,MAAA,CACA,WAAA,CACA,KAAA,OACA,QAAA,EACA,UAAA,SAAA,GACA,MAAA,iBAAA,GAAA,EAAA,IAGA,iBAAA,CACA,KAAA,WAGA,KAAA,WACA,MAAA,CACA,YAAA,IAGA,SAAA,CACA,eAAA,WACA,OAAA,IAAA,KAAA,YACA,4BAAA,OAAA,KAAA,WAAA,mCACA,KAAA,WAAA,KAAA,aAAA,EACA,qDAEA,0BAAA,OAAA,KAAA,YAAA,wCAGA,YAAA,WACA,OAAA,KAAA,WAAA,KAAA,cAGA,QAAA,WACA,KAAA,yBAEA,QAAA,CACA,YAAA,WACA,aAAA,QAAA,eACA,KAAA,YAAA,SAAA,aAAA,QAAA,iBAEA,KAAA,YAAA,EACA,aAAA,QAAA,cAAA,KAAA,cAGA,KAAA,MAAA,KAAA,MAAA,KAAA,aAAA,QAAA,gBAAA,EACA,KAAA,oBAEA,KAAA,YAAA,EACA,aAAA,QAAA,cAAA,KAIA,oBAAA,WACA,aAAA,QAAA,eAAA,KAAA,MAAA,KAAA,MAAA,OAGA,uBAAA,WAGA,KAAA,mBAGA,KAAA,kBACA,KAAA,oBAIA,iBAAA,WACA,KAAA,YAAA,KAAA,YAAA,EACA,aAAA,QAAA,cAAA,KAAA,aAEA,KAAA,cAAA,KAAA,YACA,KAAA,0BAIA,iBAAA,WACA,OAAA,oBAAA,eAAA,KAAA,qBACA,aAAA,WAAA,gBACA,aAAA,WAAA,eACA,KAAA,yBAGA,sBAAA,WACA,OAAA,iBAAA,eAAA,KAAA,qBACA,KAAA,iBAtFA,QAAA,QAAA;;;ACPe,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EAFf,IAAA,EAAA,EAAA,QAAA,mBAEe,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GAAA,IAAA,EAAA,CACbA,QAAQC,SAAAA,EAAKC,GAEXD,EAAIE,UAAU,mBAAoBC,EAAlC,WAHW,QAAA,QAAA","file":"index.js","sourceRoot":"../src","sourcesContent":["<template>\n  <div class='vtr-info'>\n    <p class='count'>reloadCount: {{ reloadCount }}</p>\n    <p class='max'>maxReloads: {{ maxReloads }}</p>\n    <p class='message'>WarningMessage: {{ warningMessage }}</p>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'TrackReload',\n  props: {\n    maxReloads: {\n      type: Number,\n      default: 3,\n      validator: (val) => {\n        return (typeof val === 'number' && val > 0)\n      }\n    },\n    maxReloadHandler: {\n      type: Function\n    }\n  },\n  data() {\n    return {\n      reloadCount: 0\n    };\n  },\n  computed: {\n    warningMessage() {\n      if (this.reloadCount === 0) {\n        return `If this page is reloaded ${this.maxReloads} times, you will be kicked off.`\n      } else if (this.maxReloads - this.reloadCount === 1) {\n        return 'This is your final warning! Do not reload anymore.'\n      } else {\n        return `Warning! If you reload ${this.reloadsLeft} more times you will be kicked off!`\n      }\n    },\n    reloadsLeft() {\n      return (this.maxReloads - this.reloadCount)\n    }\n  },\n  created() {\n    this.initializeReloadCount();\n  },\n  methods: {\n    checkReload() {\n      if (localStorage.getItem('reloadCount')) {\n        this.reloadCount = parseInt(localStorage.getItem('reloadCount'));\n      } else {\n        this.reloadCount = 0;\n        localStorage.setItem('reloadCount', this.reloadCount);\n      }\n\n      if (Math.floor(Date.now() / 1000) - localStorage.getItem('lastUnloadAt') < 5) {\n        this.onReloadDetected();\n      } else {\n        this.reloadCount = 0;\n        localStorage.setItem('reloadCount', 0);\n      }\n    },\n\n    beforeUnloadHandler() {\n      localStorage.setItem('lastUnloadAt', Math.floor(Date.now() / 1000));\n    },\n\n    handleThresholdReached() {\n      // Do something when threshold is reached, for now, just alert the user and reset\n      // alert('You\\'ve reloaded enough! Resetting');\n      this.resetReloadCount();\n      \n      // If maxReloadHandler prop passed in, call it\n      if (this.maxReloadHandler) {\n        this.maxReloadHandler()\n      }\n    },\n\n    onReloadDetected() {\n      this.reloadCount = this.reloadCount + 1;\n      localStorage.setItem('reloadCount', this.reloadCount);\n\n      if (this.reloadCount === this.maxReloads) {\n        this.handleThresholdReached();\n      }\n    },\n\n    resetReloadCount() {\n      window.removeEventListener('beforeunload', this.beforeUnloadHandler);\n      localStorage.removeItem('lastUnloadAt');\n      localStorage.removeItem('reloadCount');\n      this.initializeReloadCount();\n    },\n\n    initializeReloadCount() {\n      window.addEventListener('beforeunload', this.beforeUnloadHandler);\n      this.checkReload();\n    }\n  }\n}\n</script>\n\n<style>\n.vtr-info {\n  display: none;\n}\n</style>","import TrackReload from './track-reload'\n\nexport default {\n  install(Vue, options) {\n    // Register the component globally\n    Vue.component('vue-track-reload', TrackReload)\n  }\n}"]}